import torch

from models import Transformer

src = torch.tensor([[2,    35, 12474,     4,  5438,     5,  2461,    29,  1154,     6,
                    192,    50,   151,   248,     3,     1,     1,     1,     1,     1,
                    1,     1,     1,     1,     1,     1,     1,     1,     1,     1,
                    1,     1,     1,     1,     1,     1,     1,     1,     1,     1],
                   ])

tgt = torch.tensor([[2,     9, 12983,     4, 20848,    32,  1261,     7,  1507,     6,
                    0,     3,     1,     1,     1,     1,     1,     1,     1,     1,
                    1,     1,     1,     1,     1,     1,     1,     1,     1,     1,
                    1,     1,     1,     1,     1,     1,     1,     1,     1,     1],
                   ])

src_mask = torch.tensor([[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]])
""" 
tgt_mask = torch.tensor([[[1, 0, 0,  ..., 0, 0, 0],
                          [1, 1, 0,  ..., 0, 0, 0],
                          [1, 1, 1,  ..., 0, 0, 0],
                          ...,
                          [1, 1, 1,  ..., 0, 0, 0],
                          [1, 1, 1,  ..., 0, 0, 0],
                          [1, 1, 1,  ..., 0, 0, 0]]]) """

torch.manual_seed(0)

model = Transformer(
    20_000,
    512,
    40,
    0.3
)

out = model(src, src)
print(out)